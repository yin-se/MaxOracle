{% extends 'lotto/base.html' %}

{% block title %}数据状态 | MaxOracle{% endblock %}

{% block content %}
<h2 class="mb-3">数据状态</h2>

<div class="row g-4">
    <div class="col-lg-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="card-title">已抓取期数</h6>
                <p class="display-6 mb-0">{{ total_draws }}</p>
            </div>
        </div>
    </div>
    <div class="col-lg-8">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="card-title">最近一期</h6>
                {% if latest_draw %}
                    <p class="mb-1"><strong>日期：</strong>{{ latest_draw.date }}</p>
                    <p class="mb-0"><strong>号码：</strong>{{ latest_draw.numbers|join:' ' }} + Bonus {{ latest_draw.bonus }}</p>
                {% else %}
                    <p class="text-muted">暂无开奖数据。</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<h4 class="mt-4">最近开奖</h4>
<div class="table-responsive">
    <table class="table table-sm table-striped">
        <thead>
            <tr>
                <th>日期</th>
                <th>主号</th>
                <th>Bonus</th>
            </tr>
        </thead>
        <tbody>
            {% for draw in recent_draws %}
            <tr>
                <td>{{ draw.date }}</td>
                <td>{{ draw.numbers|join:' ' }}</td>
                <td>{{ draw.bonus }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="text-muted">暂无数据</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<h4 class="mt-4">导入日志</h4>
<div class="table-responsive">
    <table class="table table-sm table-bordered">
        <thead>
            <tr>
                <th>时间</th>
                <th>状态</th>
                <th>来源</th>
                <th>信息</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr>
                <td>{{ log.run_at }}</td>
                <td>{{ log.status }}</td>
                <td>{{ log.source }}</td>
                <td>{{ log.message }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4" class="text-muted">暂无日志</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
